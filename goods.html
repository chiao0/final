<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Blanket</title>
    <link rel="stylesheet" href="assets/css/goods.css">
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>

    <!-- 計數器 -->
    <script>
        window.onload = function() {
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    document.getElementById("counter").innerHTML = xhr.responseText;
                }
            };
            xhr.open("GET", "counter.jsp", true);
            xhr.send();
        };
    </script>
</head>

<body>

    <header>
        <nav>
            <ul class="drop-down-menu">
                <li><a href="index.html">首頁</a></li>
                <li><a href="aboutus.html">關於我們</a></li>
                <li><a href="desk.html">商品</a>
                    <ul>
                        <li><a href="desk.jsp">書桌</a></li>
                        <li><a href="chair.jsp">椅子</a></li>
                        <li><a href="cabinet.jsp">櫃子</a></li>
                        <li><a href="sofa.jsp">沙發</a></li>
                    </ul>
                </li>
            </ul>
        </nav>

        <div class="icon">
            <a href="buy.car.html">
                <img src="./assets/image/shopping.png" width="30px" height="30px"/>
            </a>
            <a href="t.html">
                <img src="./assets/image/member.png" width="30px" height="30px"/>
            </a>
        </div>

        <form action="search.jsp" method="get">
            <input id="search" type="text" name="search" placeholder="搜尋..." class="search">
            <input type="submit" value="搜索">
        </form>
    </header>

    <div class="information">
        <!-- 商品圖片 -->
        <div class="slideshow-container">
            <div class="singleSlide fade">
                <img class="productphoto" src="assets/product_images/BigSofa1.png"/>
            </div>
            <div class="singleSlide fade">
                <img class="productphoto" src="assets/product_images/BigSofa2.png"/>
            </div>
            <div class="singleSlide fade">
                <img class="productphoto" src="assets/product_images/BigSofa3.png"/>
            </div>
            <!-- 商品圖片切換按鈕 -->
            <button class="prev" onclick="plusSlides(-1)"><</button>
            <button class="next" onclick="plusSlides(1)"></button>
        </div>
        <!-- 商品圖片JS -->
        <script src="assets/js/index.js"></script>

        <!-- 商品基本資訊 -->
        <div class="card">
            <h1>貓抓皮雙人沙發</h1><br>
            <div class="price">NT$：1000</div><br>
            <div class="inventory">商品庫存：10</div>
            <form action="new1.jsp">
                <tr>
                    <td>
                        <div class="item1">
                            <!-- 調整數量的按鈕 -->
                            <input type="button" value="-" class="item_button" onclick="minus(0)">
                            <input type="text" value="1" class="item_num" name="number">
                            <input type="button" value="+" class="item_button" onclick="add(0)">
                        </div>
                    </td>

                    <!-- 加入購物車按鈕 -->
                    <td>
                        <button value="加入購物車" class="addbutton">加入購物車</button>
                    </td>
                </tr>
            </form>
        </div><br>

        <!-- 商品介紹 -->
        <div class="introduce">
            <h2>商品介紹</h2>
            <div class="features">
                <div>
                    <ul>
                        <li>養寵物專用推薦</li>
                        <li>防水防塵</li>
                        <li>清潔簡易</li>
                        <li>特殊彈簧</li>
                    </ul>
                </div>
                <div>尺寸:70*180*100公分</div>
            </div>
        </div>
    </div>

    <hr align="center" width="1300px">
    <!-- 顧客輸入評論區 -->
    <p class="commenttxt">評論區</p><br>
    <div class="comment">
        <form action="processComment.jsp" method="post" onsubmit="return validateForm()">
            <input id="name" type="text" name="username" placeholder="請輸入使用者名稱" class="username"><br>

            <!-- 星星 -->
            <div class="star" id="star-rating">
                <iconify-icon icon="solar:star-outline" width="40" data-index="1" class="star-icon"></iconify-icon>
                <iconify-icon icon="solar:star-outline" width="40" data-index="2" class="star-icon"></iconify-icon>
                <iconify-icon icon="solar:star-outline" width="40" data-index="3" class="star-icon"></iconify-icon>
                <iconify-icon icon="solar:star-outline" width="40" data-index="4" class="star-icon"></iconify-icon>
                <iconify-icon icon="solar:star-outline" width="40" data-index="5" class="star-icon"></iconify-icon>
            </div>

            <!-- 評論內容輸入區域與傳送按鈕 -->
            <p>評論內容：</p><br>
            <textarea id="content" name="content" placeholder="說點什麼..." maxlength="1000" class="content"></textarea><br>
            <button type="submit" value="send" class="sendbutton">送出</button>
        </form>
    </div>

    <!-- 評論展示區 -->
    <div class="commentarea" id="commentArea"></div>

    <!-- JavaScript 代码 -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

    <script>
        function loadComments() {
            $.ajax({
                url: 'comment.jsp',
                type: 'GET',
                success: function(response) {
                    $('#commentArea').html(response);
                },
                error: function(error) {
                    console.log('加载评论失败:', error);
                }
            });
        }
    </script>

    <script>
        // 調整數量的按鈕
        function minus(num) {
            var number = Number(document.getElementsByClassName("item_num")[num].value);
            if (number > 1) {
                number -= 1;
                document.getElementsByClassName("item_num")[num].value = number;
            } else window.alert("商品數量不得少於1");
        }
        function add(num) {
            var number = Number(document.getElementsByClassName("item_num")[num].value);
            if (number < 100) {
                number += 1;
                document.getElementsByClassName("item_num")[num].value = number;
            } else window.alert("商品數量不得超過100");
        }
    </script>

    <script>
        // 星星
        document.addEventListener("DOMContentLoaded", function () {
            const starRating = document.getElementById("star-rating");
            const starIcons = starRating.querySelectorAll(".star-icon");

            starIcons.forEach((starIcon) => {
                starIcon.addEventListener("click",function() {
                    const clickedIndex = parseInt(this.getAttribute("data-index"));
                    starIcons.forEach((icon,index) => {
                        if (index<clickedIndex) {
                            icon.setAttribute("icon","solar:star-bold");
                        } else {
                            icon.setAttribute("icon","solar:star-outline");
                        }
                    });
                    console.log("selected Rating:" + clickedIndex);
                });
            });
        });
    </script>

    <footer>
        瀏覽人數：<span id="counter"></span>
        <p>Tel：03 265 9999</p>
        <p>地址：320桃園市中壢區中北路200號</p>
        <h5>Copyrgiht @ 2023 All rights reserved</h5>
    </footer>

    <script>
        $(document).ready(function() {
            loadComments(); // 页面加载完成后调用加载评论的函数
        });
    </script>
</body>
</html>
